# 7. K-mean clustering
* [Back Home](../README.md)

## Generate the random int between.
```js
function getRandomInt(min, max) {
  min = Math.ceil(min);
  max = Math.floor(max+1);
  return Math.floor(Math.random() * (max - min)) + min; //含最大值，含最小值
}
```
## unique array
```js
function unique(arr2)
{
    arr=JSON.parse(JSON.stringify(arr2));
  if (arr.length === 0) return arr;
  arr = arr.sort(function (a, b) { return a*1 - b*1; });
  var ret = [arr[0]];
  for (var i = 1; i < arr.length; i++) { //Start loop at 1: arr[0] can never be a duplicate
    if (arr[i-1] !== arr[i]) {
      ret.push(arr[i]);
    }
  }
  return ret;

}

```

## Generate the random int between.
```js
data=[[1,1,1,1],[2,2,2,2],[3,3,3,3],[4,4,4,4],[1,2,1,1],[3,2,4,4]];
function get_Random_element_array(data,num){
    var max=data.length-1;
    var index=getRandomInt(0,max);
    // the index array.
    var index_array=[];
    var out_array=[];
    if(data.length < num)
    {
        return data;
        //break;
    }else{
        while(index_array.length<num)
        {
            index_array.push(getRandomInt(0,max));
            index_array=unique(index_array);

        }
        for(var i=0;i<index_array.length;i++)
        {
            out_array.push(data[index_array[i]]);
        }
    }
    return out_array;
}


```
## distance
```js
function distance(a,b)
{
    /*
    a is the center
    b is the center.
    */
    var dis=0;
    for(var i=0;i<a.length;i++)
    {
        var disa=a[i]-b[i];
        var disa=Math.pow(disa,2);
        dis+=disa;
    }
    dis=Math.pow(dis,0.5);
    return dis;
}
a=[1,2];
b=[2,5];
distance(a,b);

function distance_one_array(a,b){
    /*
    a: one element,like[1,2]
    b: array with server element, like [[2,3],[1,1]...]
    */
    var disarr=[];
    for(var i=0;i<b.length;i++)
    {
        var dis=distance(a,b[i]);
        disarr.push(dis);
    }
    return disarr;
}
c=[[1,1],[1,2],[2,1],[2,2]];
distance_one_array(a,c);

a=[[1,1],[1,2],[2,1]];
b=[[1,2],[2,1],[2,2]];
function distance_array_array(a,b)
{
    /*
    a: one element,like[[2,3],[1,1]...]
    b: array with server element, like [[2,3],[1,1]...]
    */
    var disarr=[];
    for(var i=0;i<b.length;i++)
    {
        var dis=distance(a[i],b[i]);
        disarr.push(dis);
    }
    var sum=0;
    for(var i=0;i<disarr.length;i++)
    {
        sum+=disarr[i];
    }
    var agv=sum/disarr.length;
    return agv;
}

distance_array_array(a,b);
```

## 
```js
function indexOfMin(arr) {
    if (arr.length === 0) {
        return -1;
    }

    var min = arr[0];
    var minIndex = 0;

    for (var i = 1; i < arr.length; i++) {
        if (arr[i] < min) {
            minIndex = i;
            min = arr[i];
        }
    }

    return minIndex;
}
```

## 

```js
function kmean_cluster_one(a,b)
{
    //a: is array 
    //b: is the number of clusters.
    
    //1. Generate the b element as the inital points.
    var center_array=get_Random_element_array(a,b);
    var center_array_new=[];

    //2. Generate the b cluster array.
    var cluster_array=[];

    //3. add element into array.
    for(var i=0;i<b;i++)
        {
            cluster_array.push([]);
        }

    //loop each a element. calculate the distance between element and center. find the mini distance. Put into the relative cluster.
    for(var i=0;i<a.length;i++)
        {   //calculateh point to each element array.
            var dis=distance_one_array(a[i],center_array);
            // get the minizest index of dis.
            var min_index=indexOfMin(dis);
            //put the point into the cluster.
            cluster_array[min_index].push(a[i]);
        }
        //for each cluster.
        for(var i=0;i<cluster_array.length;i++)
        {
            //calculateh the each cluster mean point.
          center_array_new.push(mean_array(cluster_array[i]));
        }
    //calculate the average distance of array and array.
    var distance_value=distance_array_array(center_array_new,center_array);
    //return the cluster array and center array_new, and distance value.
    return [cluster_array,center_array_new,distance_value];
}



data=[[1,1,1,1],[2,2,2,2],[3,3,3,3],[4,4,4,4],[1,2,1,1],[3,2,4,4]];
kmean_cluster_one(data,3);
```
```js
data=[[1,1,1,1],[2,2,2,2],[3,3,3,3],[4,4,4,4],[1,2,1,1],[3,2,4,4]];
function kmean_cluster_process(data,3,center_array)
{
    //a: is array 
    //b: is the number of clusters.
    //c: is the center array.
    
    var center_array=center_array;

       //2. Generate the b cluster array.
    var cluster_array=[];

    //3. add element into array.
    for(var i=0;i<b;i++)
        {
            cluster_array.push([]);
        }

    //loop each a element. calculate the distance between element and center. find the mini distance. Put into the relative cluster.
    for(var i=0;i<a.length;i++)
        {   //calculateh point to each element array.
            var dis=distance_one_array(a[i],center_array);
            // get the minizest index of dis.
            var min_index=indexOfMin(dis);
            //put the point into the cluster.
            cluster_array[min_index].push(a[i]);
        }
        //for each cluster.
        for(var i=0;i<cluster_array.length;i++)
        {
            //calculateh the each cluster mean point.
          center_array_new.push(mean_array(cluster_array[i]));
        }
    //calculate the average distance of array and array.
    var distance_value=distance_array_array(center_array_new,center_array);
    //return the cluster array and center array_new, and distance value.
    return [cluster_array,center_array_new,distance_value];
}


```


