# PCA

## train_pca
```js
function train_pca(){
  //get the html data
  pca_data_a=getinforvalue('training_decision');
  pca_label_a=getinforlabel('label_decision');


//Use new dataset to calculate the PCA module.
pca=new ML.PCA(pca_data_a);

//export the PCA module parameter.
pca_result=pca.toJSON();


predict_result=pca.predict(pca_data_a);

//
$(".predict_pca").show();

//threedplot(pca_data_a,'3dplot');
//threedplot(predict_result,'3dplotnew');

threedlabelplot(pca_data_a,pca_label_a,'3dplot');
threedlabelplot(predict_result,pca_label_a,'3dplotnew');
}

console.log(pca.getExplainedVariance());
```

### threedlabelplot(data3d, label,nameid)
```js

function threedlabelplot(data3d, label,nameid)
{
  function sort_unique(arr) 
  {
  if (arr.length === 0) return arr;
  arr = arr.sort(function (a, b) { return a*1 - b*1; });
  var ret = [arr[0]];
  for (var i = 1; i < arr.length; i++) { //Start loop at 1: arr[0] can never be a duplicate
    if (arr[i-1] !== arr[i]) {
      ret.push(arr[i]);
    }
  }
  return ret;
  }

  label_unique=sort_unique(label);
  for (var i =0; i < label_unique.length; i++)
  {
    window['orderarray_'+i]=[];
    window['x_'+i]=[];
    window['y_'+i]=[];
    window['z_'+i]=[];
    for(var j=0;j<label.length;j++){
      if(label[j]==label_unique[i])
      {
        window['orderarray_'+i].push(j);
      }
    }
  }

  for(var i =0; i < label_unique.length; i++)
  {
    for(var j=0;j<window['orderarray_'+i].length;j++)
    {
      window['x_'+i].push(data3d[window['orderarray_'+i][j]][0]);
      window['y_'+i].push(data3d[window['orderarray_'+i][j]][1]);
      window['z_'+i].push(data3d[window['orderarray_'+i][j]][2]);
    }
  }
  var data=[];
  for(var i =0; i < label_unique.length; i++)
  {
    window['trace'+i]={
      x:window['x_'+i],
      y:window['y_'+i],
      z:window['z_'+i],
      name:i,

    mode: 'markers',
    marker: 
      {
        size: 4,
        line: {
        //color: 'rgba(217, 217, 217, 0.14)',
        width: 0.5
        },
        opacity: 0.8
      },
    type: 'scatter3d'
    }
    data.push(window['trace'+i]);

  }

  var layout = {};
  Plotly.newPlot(nameid, data, layout);
}

```


```js

function twodlabelplot(data3d, label,nameid)
{
  function sort_unique(arr) 
  {
  if (arr.length === 0) return arr;
  arr = arr.sort(function (a, b) { return a*1 - b*1; });
  var ret = [arr[0]];
  for (var i = 1; i < arr.length; i++) { //Start loop at 1: arr[0] can never be a duplicate
    if (arr[i-1] !== arr[i]) {
      ret.push(arr[i]);
    }
  }
  return ret;
  }

  label_unique=sort_unique(label);
  for (var i =0; i < label_unique.length; i++)
  {
    window['orderarray_'+i]=[];
    window['x_'+i]=[];
    window['y_'+i]=[];
    for(var j=0;j<label.length;j++){
      if(label[j]==label_unique[i])
      {
        window['orderarray_'+i].push(j);
      }
    }
  }

  for(var i =0; i < label_unique.length; i++)
  {
    for(var j=0;j<window['orderarray_'+i].length;j++)
    {
      window['x_'+i].push(data3d[window['orderarray_'+i][j]][0]);
      window['y_'+i].push(data3d[window['orderarray_'+i][j]][1]);
    }
  }
  var data=[];
  for(var i =0; i < label_unique.length; i++)
  {
    window['trace'+i]={
      x:window['x_'+i],
      y:window['y_'+i],
      name:i,

    mode: 'markers',
    marker: 
      {
        size: 4,
        line: {
        //color: 'rgba(217, 217, 217, 0.14)',
        width: 0.5
        },
        opacity: 0.8
      },
    type: 'scatter3d'
    }
    data.push(window['trace'+i]);

  }

  var layout = {};
  Plotly.newPlot(nameid, data, layout);
}

```


